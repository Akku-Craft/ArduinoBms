\doxysection{BMS\+\_\+\+Definitions.\+h}
\hypertarget{BMS__Definitions_8h_source}{}\label{BMS__Definitions_8h_source}\index{include/BMS\_Definitions.h@{include/BMS\_Definitions.h}}
\mbox{\hyperlink{BMS__Definitions_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ BMS\_Definitions.h}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ BMS\_DEFINITIONS\_H}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ BMS\_DEFINITIONS\_H}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <Arduino.h>}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ NUM\_CELLS\_PER\_UNIT\ 2}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ MAX\_UNITS\ \ \ \ \ \ \ \ \ \ 5}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ NUM\_UNITS\ \ \ \ \ \ \ \ \ \ 5}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#define\ ACK\_SIGNAL\ \ \ \ \ \ \ \ \ 0x06}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{comment}{//\ Pin\ definierung}}
\DoxyCodeLine{00013\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{BMS__Definitions_8h_a4ddb798fd4965c67a016006ae220fad9}{PIN\_ZELLE1}}\ =\ A1;}
\DoxyCodeLine{00014\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{BMS__Definitions_8h_a868bac69a83b557d4c37d10f6e59c3a5}{PIN\_GESAMT}}\ =\ A2;}
\DoxyCodeLine{00015\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{BMS__Definitions_8h_a9ae9bb41a95a6f306c9105ce1066b452}{PIN\_MAIN\_SWITCH}}\ =\ 4;\ \textcolor{comment}{//\ D4\ Steuert\ den\ Last-\/MOSFET}}
\DoxyCodeLine{00016\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{BMS__Definitions_8h_ab9be5206cd9ff071693229ab94812c87}{PIN\_STATUS\_LED}}\ =\ 13;\ \textcolor{comment}{//\ Onboard\ LED}}
\DoxyCodeLine{00017\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{BMS__Definitions_8h_a97dcfda2e6c10690ce6726310d36c929}{PIN\_MOSFET\_ZELLE1}}\ =\ 5;}
\DoxyCodeLine{00018\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{BMS__Definitions_8h_a75d7e14eb70d479c2631321f9466ad8e}{PIN\_MOSFET\_ZELLE2}}\ =\ 6;}
\DoxyCodeLine{00019\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{BMS__Definitions_8h_a1a20caa08cb867b770f33b9f1529ad6e}{Stromsensor\_pin}}\ =\ A3;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{comment}{//\ Konstanten\ fuer\ die\ Berechnungen\ und\ das\ Balancing\ }}
\DoxyCodeLine{00022\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{BMS__Definitions_8h_ad7a5b0a2de6c07b3629ea990a6741779}{V\_REF}}\ =\ 5.0;\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Exakte\ Spannung\ am\ 5V\ Pin\ (bitte\ nachmessen!)}}
\DoxyCodeLine{00023\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{BMS__Definitions_8h_a5dd46831fa05337e7dc10b3f8e3d1bb5}{DIVIDER\_FAKTOR}}\ =\ 2.0;\ \textcolor{comment}{//\ Da\ 10k/10k\ Teiler\ die\ Spannung\ halbiert}}
\DoxyCodeLine{00024\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{BMS__Definitions_8h_aa988acb49bf5002d58467afdb63eaec1}{MIN\_VOLT\_ZELLE}}\ =\ 3.0;\ \textcolor{comment}{//\ Abschaltung\ bei\ 3.0V\ pro\ Zelle}}
\DoxyCodeLine{00025\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{BMS__Definitions_8h_a46d338b9a446186edbd286a59792f5f9}{MAX\_VOLT\_ZELLE}}\ =\ 4.2;\ \textcolor{comment}{//\ 100\%\ bei\ 4.2V\ pro\ Zelle}}
\DoxyCodeLine{00026\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{BMS__Definitions_8h_ac3b1397319fee50ff394c20857799d68}{diffStart}}\ =\ 0.05;\ \textcolor{comment}{//\ Wert\ der\ Differenz\ bei\ der\ das\ Balancing\ gestartet\ werden\ soll}}
\DoxyCodeLine{00027\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{BMS__Definitions_8h_aee0998c835c86025682d05621fecf8b2}{diffStop}}\ =\ 0.01;\ \ \textcolor{comment}{//\ Wert\ der\ Differenz\ bei\ der\ das\ Balancing\ gestoppy\ werden\ soll\ bzw.\ die\ Tolelranz\ die\ die\ beiden\ Zellen\ max.\ ahebn\ duerfen}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{comment}{//\ die\ verschiedenen\ System\ moeglichkeiten}}
\DoxyCodeLine{00030\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{BMS__Definitions_8h_a2cc3130d597bd9e7880b6497496b4f35}{SystemStatus}}\{}
\DoxyCodeLine{00031\ \ \ \mbox{\hyperlink{BMS__Definitions_8h_a2cc3130d597bd9e7880b6497496b4f35a99ade6ecff7f9e1fb13b62be39b85d82}{STATUS\_IDLE}},\ \ \ \ \ \ \textcolor{comment}{//\ Alles\ okay,\ keine\ Last}}
\DoxyCodeLine{00032\ \ \ \mbox{\hyperlink{BMS__Definitions_8h_a2cc3130d597bd9e7880b6497496b4f35af30ec43aafecdab92059456f958bed6b}{STATUS\_DISCHARGE}},\ \textcolor{comment}{//\ Akku\ wird\ entladen}}
\DoxyCodeLine{00033\ \ \ \mbox{\hyperlink{BMS__Definitions_8h_a2cc3130d597bd9e7880b6497496b4f35ab92c562e47556eda47c6e89a464431c2}{STATUS\_CHARGE}},\ \ \ \ \textcolor{comment}{//\ Akku\ wird\ geladen}}
\DoxyCodeLine{00034\ \ \ \mbox{\hyperlink{BMS__Definitions_8h_a2cc3130d597bd9e7880b6497496b4f35a5dc99a8c776227c891d1e3351c498738}{STATUS\_CRITICAL}},\ \ \textcolor{comment}{//\ Not-\/Aus\ wegen\ Unterspannung}}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{BMS__Definitions_8h_a2cc3130d597bd9e7880b6497496b4f35a24acd74f6ddd85685f53c991e57c0efa}{STATUS\_FULL}}\ \ \ \ \ \ \ \textcolor{comment}{//\ Akku\ ist\ voll,\ Laden\ stoppenmeintest\ du\ vorhin\ nicht\ irgentwas\ mit\ ic2}}
\DoxyCodeLine{00036\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{enum}\ PacketType\ \{}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{BMS__Definitions_8h_a6f9ce8d923c79b500e58d324a5dd806a}{TYPE\_SCAN}},\ \ \ \ \ \textcolor{comment}{//\ Datensammeln\ (Spannungen\ lesen)}}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{BMS__Definitions_8h_a091844df86d9d8164fd4cd35a4c0e7dc}{TYPE\_BALANCE}},\ \ \textcolor{comment}{//\ Befehl\ (Balancing\ ein/aus)}}
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{BMS__Definitions_8h_a3bb4113b7116302500fa1836659d62f1}{TYPE\_EMERGENCY}}\ \textcolor{comment}{//\ Sofort-\/Aus\ für\ alle}}
\DoxyCodeLine{00042\ \};}
\DoxyCodeLine{00043\ \ \ \ }
\DoxyCodeLine{00044\ \textcolor{comment}{//\ diese\ Struktur\ representiert\ die\ einzelnen\ Einheiten\ in\ der\ Head\ Zelle}}
\DoxyCodeLine{00045\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structCellData}{CellData}}\ \{}
\DoxyCodeLine{00046\ \textcolor{comment}{//\ Messwerte}}
\DoxyCodeLine{00047\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structCellData_a0ec90667df428dd2922231a7c6996a2a}{voltage\_mV}};\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Aktuelle\ Gesamtzellspannung\ in\ Millivolt}}
\DoxyCodeLine{00048\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structCellData_a5ae2c571bb3d77a4b574e824da8631a3}{voltage\_Cell1}};\ \ \ \ \ \ \textcolor{comment}{//\ Zellspannung\ der\ ersten\ Zelle}}
\DoxyCodeLine{00049\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structCellData_a3b299a4e2f50c8b13d8c35acd7f0484b}{voltage\_Cell2}};\ \ \ \ \ \ \textcolor{comment}{//\ Zellspannung\ der\ zweiten\ Zelle}}
\DoxyCodeLine{00050\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structCellData_a796fdbd91ae6e5920589cfa32cb864c8}{temperature\_C}};\ \ \ \ \ \ \textcolor{comment}{//\ Aktuelle\ Zelltemperatur\ in\ Grad\ Celsius}}
\DoxyCodeLine{00051\ \ \ \textcolor{comment}{//\ Status\ \&\ Steuerung}}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structCellData_af289e910abd8e54c1b8d430f3a2b3c5f}{is\_balancing\_1}};\ \ \ \ \ \ \textcolor{comment}{//\ TRUE,\ wenn\ der\ Balancierwiderstand\ dieser\ Zelle\ aktiv\ ist}}
\DoxyCodeLine{00053\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structCellData_a5fe0a6ef731c9b5a842dc34c9fa2e19c}{is\_balancing\_2}};\ \ \ \ \ \ \textcolor{comment}{//\ TRUE,\ wenn\ der\ Balancierwiderstand\ dieser\ Zelle\ aktiv\ ist}}
\DoxyCodeLine{00054\ \ \ \mbox{\hyperlink{BMS__Definitions_8h_a2cc3130d597bd9e7880b6497496b4f35}{SystemStatus}}\ \mbox{\hyperlink{structCellData_a9d59c73aaf62887a551f37ee28532ea6}{status}};}
\DoxyCodeLine{00055\ \};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{comment}{//\ die\ Struktur\ ehthaelt\ alle\ werte\ fuer\ das\ ScanPacket}}
\DoxyCodeLine{00058\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structSingleUnitData}{SingleUnitData}}\ \{}
\DoxyCodeLine{00059\ \ \ uint16\_t\ \mbox{\hyperlink{structSingleUnitData_aa4a2a650237b8440b5da5adb1176ec90}{vCell1\_mV}};\ \ \ \ \textcolor{comment}{//\ z.B.\ 3750\ für\ 3.75V}}
\DoxyCodeLine{00060\ \ \ uint16\_t\ \mbox{\hyperlink{structSingleUnitData_aa43400a8e63623fd20b2d25f2c580fe2}{vCell2\_mV}};}
\DoxyCodeLine{00061\ \ \ int16\_t\ \mbox{\hyperlink{structSingleUnitData_aacc08aebb2f49cbb80cfdacccfd91c04}{temp\_C}};}
\DoxyCodeLine{00062\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structSingleUnitData_a93431751a9a7d43dc76796d631ead20e}{number}};}
\DoxyCodeLine{00063\ \};}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{comment}{//\ dieses\ Packet\ wird\ rumgeschickt\ um\ die\ Daten\ aller\ Einheiten\ zu\ erhalten}}
\DoxyCodeLine{00066\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structScanPacket}{ScanPacket}}\ \{}
\DoxyCodeLine{00067\ \ \ uint8\_t\ \mbox{\hyperlink{structScanPacket_a48766be4b748eb98e857d3706f914d33}{startByte}};}
\DoxyCodeLine{00068\ \ \ uint8\_t\ \mbox{\hyperlink{structScanPacket_a5542ffcaff74827afe8d8aaefd7c51cd}{type}};}
\DoxyCodeLine{00069\ \ \ uint8\_t\ \mbox{\hyperlink{structScanPacket_a9a175093bf0aacd5d9f7497fda342101}{activeUnits}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Wie\ viele\ haben\ sich\ eingetragen?}}
\DoxyCodeLine{00070\ \ \ \mbox{\hyperlink{structSingleUnitData}{SingleUnitData}}\ \mbox{\hyperlink{structScanPacket_ae8683259e5160bd11632b4e5831d6212}{units}}[\mbox{\hyperlink{BMS__Definitions_8h_a7cfb67162d1c27efd40371d00adfb0b8}{MAX\_UNITS}}];}
\DoxyCodeLine{00071\ \ \ uint8\_t\ \mbox{\hyperlink{structScanPacket_ae490137c65bdc948c7e94e1b25195061}{checksum}};}
\DoxyCodeLine{00072\ \};}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{comment}{//\ diese\ Struktur\ ist\ der\ Rueckgabewert\ der\ Funktion\ die\ die\ einzelnen\ Zellwerte\ ausliesst}}
\DoxyCodeLine{00075\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmeasure__Cell__Data}{measure\_Cell\_Data}}\ \{}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structmeasure__Cell__Data_a7836f54df2bd3abc456d196003420d0a}{voltage\_mV}};\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Aktuelle\ Gesamtzellspannung\ in\ Millivolt}}
\DoxyCodeLine{00077\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structmeasure__Cell__Data_ad5b63a426d6c213060d572dd4ffcf15b}{voltage\_Cell1}};\ \ \ \ \ \ \textcolor{comment}{//\ Zellspannung\ der\ ersten\ Zelle}}
\DoxyCodeLine{00078\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structmeasure__Cell__Data_a0139a01cd1f57b433513e58e9adc35e4}{voltage\_Cell2}};\ \ \ \ \ \ \textcolor{comment}{//\ Zellspannung\ der\ zweiten\ Zelle}}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structmeasure__Cell__Data_a2a68336614b7bfcb2afec28e3b05fcc0}{temperature\_C}};}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
